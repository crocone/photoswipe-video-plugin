/*!
  * PhotoSwipe Lightbox 5.1.7 - https://photoswipe.com
  * (c) 2021 Dmitry Semenov
  */
function e(e,t,s){const i=document.createElement(t||"div");return e&&(i.className=e),s&&s.appendChild(i),i}function t(e,t,s){e.style.width="number"==typeof t?t+"px":t,e.style.height="number"==typeof s?s+"px":s}const s="idle",i="loading",o="loaded",n="error";const d={videoAttributes:{controls:"",playsinline:"",preload:"auto"},autoplay:!0};class a extends class extends class{constructor(e,t){this.options=t.options,this.instance=t,this.data=e,this.width=Number(this.data.w)||Number(this.data.width)||0,this.height=Number(this.data.h)||Number(this.data.height)||0,this.isAttached=!1,this.state=s}setSlide(e){this.slide=e,this.pswp=e.pswp}load(){this.element||(this.element=e("pswp__content"),this.element.style.position="absolute",this.element.style.left=0,this.element.style.top=0,this.element.innerHTML=this.data.html||"")}isZoomable(){return!1}usePlaceholder(){return!1}activate(){}deactivate(){}setDisplayedSize(e,s){this.element&&t(this.element,e,s)}onLoaded(){this.state=o,this.slide&&this.pswp.dispatch("loadComplete",{slide:this.slide})}keepPlaceholder(){return this.state===i}onError(){this.state=n,this.slide&&(this.pswp.dispatch("loadComplete",{slide:this.slide,isError:!0}),this.pswp.dispatch("loadError",{slide:this.slide}))}getErrorElement(){return!1}remove(){this.isAttached=!1,this.element&&this.element.parentNode&&this.element.remove()}appendTo(e){this.isAttached=!0,this.element&&!this.element.parentNode&&e.appendChild(this.element)}destroy(){}}{load(){if(this.element)return;const t=this.data.src;t&&(this.element=e("pswp__img","img"),this.data.srcset&&(this.element.srcset=this.data.srcset),this.element.src=t,this.element.alt=this.data.alt||"",this.state=i,this.element.complete?this.onLoaded():(this.element.onload=()=>{this.onLoaded()},this.element.onerror=()=>{this.onError()}))}setDisplayedSize(e,s){const i=this.element;i&&(t(i,e,"auto"),i.srcset&&(!i.dataset.largestUsedSize||e>i.dataset.largestUsedSize)&&(i.sizes=e+"px",i.dataset.largestUsedSize=e),this.slide&&this.pswp.dispatch("imageSizeChange",{slide:this.slide,width:e,height:s}))}isZoomable(){return this.state!==n}usePlaceholder(){return!0}lazyLoad(){this.load()}destroy(){this.element&&(this.element.onload=null,this.element.onerror=null,this.element=null)}appendTo(e){this.isAttached=!0,this.slide&&!this.slide.isActive&&"decode"in this.element?(this.isDecoding=!0,requestAnimationFrame((()=>{this.element&&this.element.decode().then((()=>{this.isDecoding=!1,requestAnimationFrame((()=>{this.appendImageTo(e)}))})).catch((()=>{}))}))):this.appendImageTo(e)}activate(){this.slide&&this.slide.container&&this.isDecoding&&this.appendImageTo(this.slide.container)}getErrorElement(){const t=e("pswp__error-msg-container");t.innerHTML=this.options.errorMsg;const s=t.querySelector("a");return s&&(s.href=this.data.src),t}appendImageTo(e){this.element&&!this.element.parentNode&&this.isAttached&&e.appendChild(this.element)}}{load(){if(!this.element){if(this.state="loading",this.type="video",this.element=document.createElement("video"),window.pswpTempTestVars&&!window.pswpTempTestVars.play_inline&&delete d.videoAttributes.playsinline,d.videoAttributes)for(let e in d.videoAttributes)this.element.setAttribute(e,d.videoAttributes[e]||"");this.element.setAttribute("poster",this.data.msrc),this.preloadVideoPoster(this.data.msrc),this.element.style.position="absolute",this.element.style.left=0,this.element.style.top=0,this.data.videoSources?this.data.videoSources.forEach((e=>{let t=document.createElement("source");t.src=e.src,t.type=e.type,this.element.appendChild(t)})):this.data.videoSrc&&(this.element.src=this.data.videoSrc)}}activate(){window.pswpTempTestVars&&!window.pswpTempTestVars.autoplay_video||this.playVideo()}deactivate(){this.pauseVideo()}playVideo(){this.element&&this.element.play()}pauseVideo(){this.element&&this.element.pause()}appendTo(e){this.isAttached=!0,this.appendImageTo(e)}isZoomable(){return!1}keepPlaceholder(){return!0}setDisplayedSize(e,t){if(this.element&&(this.element.style.width=e+"px",this.element.style.height=t+"px"),this.slide&&this.slide.placeholder){const s=this.slide.placeholder.element.style;s.transform="none",s.width=e+"px",s.height=t+"px"}}destroy(){super.destroy(),this._videoPosterImg&&(this._videoPosterImg.onload=this._videoPosterImg.onerror=null,this._videoPosterImg=null)}preloadVideoPoster(e){!this._videoPosterImg&&e&&(this._videoPosterImg=new Image,this._videoPosterImg.src=e,this._videoPosterImg.complete?this.onLoaded():this._videoPosterImg.onload=this._videoPosterImg.onerror=()=>{this.onLoaded()})}}const r={};class l{constructor(e,t){e.on("init",(()=>{this.handlePhotoSwipeInit(e.pswp,t)}))}handlePhotoSwipeInit(e,t){this.pswp=e,this.options={...r,...t},window.pswpTempTestVars&&window.pswpTempTestVars.prevent_dragging_over_video&&e.on("pointerDown",(e=>{"VIDEO"===e.originalEvent.target.tagName&&e.preventDefault()})),e.on("pointerDown",(t=>{const s=e.currSlide;if("video"===s.data.type){const e=t.originalEvent;if("pointerdown"===e.type){const i=Math.ceil(s.height*s.currZoomLevel)+s.bounds.center.y,o=e.pageY-this.pswp.offset.y;o>i-40&&o<i&&t.preventDefault()}}})),e.on("appendHeavy",(e=>{"video"!==e.slide.data.type||e.slide.isActive||e.preventDefault()})),e.on("close",(()=>{e.currSlide.content&&"video"===e.currSlide.content.type&&(e.options.showHideAnimationType&&"zoom"!==e.options.showHideAnimationType||(e.options.showHideAnimationType="fade"),e.currSlide.content.pauseVideo())})),e.addFilter("placeholderSrc",((e,t)=>"video"===t.data.type?t.data.msrc:e)),e.addFilter("domItemData",((e,t,s)=>{"video"===e.type&&s&&(s.dataset.pswpVideoSources?e.videoSources=JSON.parse(pswpVideoSources):s.dataset.pswpVideoSrc?e.videoSrc=s.dataset.pswpVideoSrc:e.videoSrc=s.href)})),e.addContentType("video",a)}}export{l as default};
